<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><title> 偏差与方差</title><meta name="description" content="学习算法的预测误差, 或者说泛化误差(generalization error)可以分解为三个部分: 偏差(bias), 方差(variance) 和噪声(noise). 在估计学习算法性能的过程中, 我们主要关注偏差与方差. 因为噪声属于不可约减的误差 (irreducible error)."><link rel="canonical" href="http://localhost:4000/blog-cn/posts/bias-variance/"><link rel="alternate" type="application/rss+xml" title="Liu-Cheng Xu" href="http://localhost:4000/blog-cn/feed.xml"><link href='https://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700|Roboto+Condensed:700&subset=latin' rel='stylesheet' type='text/css'><link rel="stylesheet" href="http://localhost:4000/blog-cn/assets/css/main.css"><link rel="shortcut icon" href="/assets/images/x.gif"><meta property="og:url" content="http://localhost:4000/posts/bias-variance/"><meta property="og:type" content="website"><meta property="og:title" content="偏差与方差"><meta property="og:description" content=""><meta property="og:site_name" content="Liu-Cheng Xu"><meta name="twitter:card" content="summary"><meta name="twitter:url" content="http://localhost:4000/posts/bias-variance/"><meta name="twitter:title" content="偏差与方差"><meta name="twitter:description" content=""><meta property="og:image" content="http://localhost:4000/assets/images/bg.svg"><meta name="twitter:image" content="http://localhost:4000/assets/images/bg.svg"> <script type="text/x-mathjax-config"> MathJax.Hub.Config({ tex2jax: { inlineMath: [ ['$','$'], ["\\(","\\)"] ], displayMath: [ ['$$','$$'], ["\\[","\\]"] ], processEscapes: true, skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'], }, TeX: { equationNumbers: { autoNumber: "AMS" } } }); MathJax.Hub.Queue(function() { var all = MathJax.Hub.getAllJax(), i; for(i=0; i < all.length; i += 1) { all[i].SourceElement().parentNode.className += ' has-jax'; } }); </script> <script type="text/javascript" async src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script> <script type="text/javascript" charset="utf-8"> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments) },i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-73260325-3', 'auto'); ga('send', 'pageview'); </script><body><div id="shadow"></div><header class="main-header content-wrapper"> <input type="checkbox" id="menu-checkbox" /><nav class="center-wrapper nav-main"> <a class="blog-logo" href="/blog-cn/">Liu-Cheng Xu</a> <a href="https://github.com/liuchengxu">GitHub</a> <a href="/blog-cn/about/">About</a> <a href="/blog-cn/feed.xml">RSS</a> <label for="menu-checkbox" class="toggle-button" data-open="☰" data-close="☰" onclick></label></nav></header><main class="content-wrapper"><article class="post"><h1 class="post-title">偏差与方差</h1><p class="post-meta"> <time datetime="2017-04-23">23-04-2017</time><div class="post-content"><p>学习算法的预测误差, 或者说泛化误差(generalization error)可以分解为三个部分: 偏差(bias), 方差(variance) 和噪声(noise). 在估计学习算法性能的过程中, 我们主要关注偏差与方差. 因为噪声属于不可约减的误差 (irreducible error).<p>首先抛开机器学习的范畴, 从字面上来看待这两个词:<ul><li><p>偏差.<p>这里的偏指的是 <strong>偏离</strong> , 那么它偏离了什么到导致了误差? 潜意识上, 当谈到这个词时, 我们可能会认为它是偏离了某个潜在的 “标准”, 而这里这个 “标准” 也就是真实情况 (ground truth). 在分类任务中, 这个 “标准” 就是真实标签 (label).<li><p>方差.<p>很多人应该都还记得在统计学中, 一个随机变量的方差描述的是它的离散程度, 也就是该随机变量在其期望值附近的 <strong>波动程度</strong> . 取自维基百科一般化的方差定义:<blockquote><p>如果 $X$ 是一个向量其取值范围在实数空间$R^n$，并且其每个元素都是一个一维随机变量，我我们就称 $X$ 为随机向量。随机向量的方差是一维随机变量方差的自然推广，其定义为$E[(X-\mu)(X-\mu)^T]$，其中$\mu=E(X)$, $X^T$是 $X$ 的转置.</blockquote></ul><p>先从下面的靶心图来对方差与偏差有个直观的感受, 我对原图 <sup id="fnref:3"><a href="#fn:3" class="footnote">1</a></sup> 进行了重绘:<p><img src="/blog-cn/assets/images/posts/bulls-eye-diagram.png" width="80%" height="30%" /><p>假设红色的靶心区域是学习算法完美的正确预测值, 蓝色点为每个数据集所训练出的模型对样本的预测值, 当我们从靶心逐渐向外移动时, 预测效果逐渐变差.<p>很容易看出有两副图中蓝色点比较集中, 另外两幅中比较分散, 它们描述的是方差的两种情况. 比较集中的属于方差小的, 比较分散的属于方差大的情况.<p>再从蓝色点与红色靶心区域的位置关系, 靠近红色靶心的属于偏差较小的情况, 远离靶心的属于偏差较大的情况.<p><img src="/blog-cn/assets/images/posts/bulls-eye-label-diagram.png" width="80%" height="30%" /><p>有了直观感受以后, 下面来用公式推导泛化误差与偏差与方差, 噪声之间的关系.<table><thead><tr><th style="text-align: center">符号<th style="text-align: center">涵义<tbody><tr><td style="text-align: center">$\mathbf{x}$<td style="text-align: center">测试样本<tr><td style="text-align: center">$D$<td style="text-align: center">数据集<tr><td style="text-align: center">$y_{D}$<td style="text-align: center">$\mathbf{x}$ 在数据集中的标记<tr><td style="text-align: center">$y$<td style="text-align: center">$\mathbf{x}$ 的真实标记<tr><td style="text-align: center">$f$<td style="text-align: center">训练集 $D$ 学得的模型<tr><td style="text-align: center">$f(\mathbf{x}; D)$<td style="text-align: center">由训练集 $D$ 学得的模型 $f$ 对 $\mathbf{x}$ 的预测输出<tr><td style="text-align: center">$\bar{f}(\mathbf{x})$<td style="text-align: center">模型 $f$ 对 $\mathbf{x}$ 的 <strong>期望预测</strong> 输出</table><h4 id="泛化误差">泛化误差</h4><p>以回归任务为例, 学习算法的平方预测误差期望为:<p>\begin{equation} Err(\mathbf{x}) = E\left[\left( y - f(\mathbf{x}; D) \right)^2\right] \end{equation}<h4 id="方差">方差</h4><p>在一个训练集 $D$ 上模型 $f$ 对测试样本 $\mathbf{x}$ 的预测输出为 $f(\mathbf{x}; D)$, 那么学习算法 $f$ 对测试样本 $\mathbf{x}$ 的 <strong>期望预测</strong> 为:<p>\begin{equation} \overline{f}(\mathbf{x}) = E_D\left[f\left(\mathbf{x}; D\right)\right] \end{equation}<p>上面的期望预测也就是针对 <strong>不同</strong> 数据集 $D$, $f$ 对 $\mathbf{x}$ 的预测值取其期望, 也被叫做 average predicted <sup id="fnref:1"><a href="#fn:1" class="footnote">2</a></sup>.<p>使用样本数相同的不同训练集产生的方差为:<p>\begin{equation} var(\mathbf{x}) = E_D\left[\left( f(\mathbf{x}; D) - \overline{f}(\mathbf{x}) \right)^2\right] \end{equation}<h4 id="噪声">噪声</h4><p>噪声为真实标记与数据集中的实际标记间的偏差:<p>\begin{equation} \epsilon^2 = E_D\left[ (y_D - y)^2 \right] \end{equation}<h4 id="偏差">偏差</h4><p>期望预测与真实标记的误差称为偏差(bias), 为了方便起见, 我们直接取偏差的平方:<p>\begin{equation} bias^2(\mathbf{x}) = \left( \overline{f}(\mathbf{x}) - y \right)^2 \end{equation}<p>对算法的期望泛化误差进行分解:<p><img src="/blog-cn/assets/images/posts/bias-variance-proof.png" alt="" /><p>不要被上面的公式吓到, 其实不复杂, 在已知结论的情况下, 了解每一项的意义, 就是一个十分简单的证明题而已, 蓝色部分是对上面对应的等价替换, 然后对其展开后, 红色部分刚好为 0.<p>对最终的推导结果稍作整理:<p><img src="/blog-cn/assets/images/posts/bias-variance.png" alt="bias-variance" /><p>至此, 继续来看一下偏差, 方差与噪声的含义 <sup id="fnref:2"><a href="#fn:2" class="footnote">3</a></sup>:<ul><li><p>偏差.<p>偏差度量了学习算法的期望预测与真实结果的偏离程序, 即 <strong>刻画了学习算法本身的拟合能力</strong> .<li><p>方差.<p>方差度量了同样大小的训练集的变动所导致的学习性能的变化, 即 <strong>刻画了数据扰动所造成的影响</strong> .<li><p>噪声.<p>噪声表达了在当前任务上任何学习算法所能达到的期望泛化误差的下界, 即 <strong>刻画了学习问题本身的难度</strong> . 巧妇难为无米之炊, 给一堆很差的食材, 要想做出一顿美味, 肯定是很有难度的.</ul><p>想当然地, 我们希望偏差与方差越小越好, 但实际并非如此. 一般来说, 偏差与方差是有冲突的, 称为偏差-方差窘境 (bias-variance dilemma).<ul><li><p>给定一个学习任务, 在训练初期, 由于训练不足, 学习器的拟合能力不够强, 偏差比较大, 也是由于拟合能力不强, 数据集的扰动也无法使学习器产生显著变化, 也就是欠拟合的情况;<li><p>随着训练程度的加深, 学习器的拟合能力逐渐增强, 训练数据的扰动也能够渐渐被学习器学到;<li><p>充分训练后, 学习器的拟合能力已非常强, 训练数据的轻微扰动都会导致学习器发生显著变化, 当训练数据自身的、非全局的特性被学习器学到了, 则将发生过拟合.</ul><p>再进一步明确一点, 训练程度其实说是模型复杂度更合适. scott 文章中的图示也十分直观, 随着模型复杂度的提升, 偏差逐渐减小, 方差逐渐增大.<p><img src="/blog-cn/assets/images/posts/bias-variance-model-complexity.png" alt="bias-variance" /><p>关于偏差与方差其实还有一些可聊的内容, 未完待续 <sup id="fnref:4"><a href="#fn:4" class="footnote">4</a></sup>.<p>参考资料:<div class="footnotes"><ol><li id="fn:3"><p><a href="http://scott.fortmann-roe.com/docs/BiasVariance.html">Understanding the Bias-Variance Tradeoff</a> <a href="#fnref:3" class="reversefootnote">&#8617;</a><li id="fn:1"><p><a href="https://twitter.com/chrisalbon/status/855110599721664512">Bias variance tradeoff 公式图解</a> . <a href="#fnref:1" class="reversefootnote">&#8617;</a><li id="fn:2"><p>«机器学习», 周志华, 2.5 节偏差与方差. <a href="#fnref:2" class="reversefootnote">&#8617;</a><li id="fn:4"><p><a href="https://www.zhihu.com/question/27068705">机器学习中的Bias(偏差)，Error(误差)，和Variance(方差)有什么区别和联系？</a> <a href="#fnref:4" class="reversefootnote">&#8617;</a></ol></div><a class="link-to-post" href="/blog-cn/posts/nosql-in-python/"> <span class="link-to-post__next">&#10535; &nbsp;Next post</span> <span class="link-to-post__title">用 Python 写一个 NoSQL 数据库</span> </a> <a class="link-to-post" href="/blog-cn/posts/perceptron/"> <span class="link-to-post__prev">&#10535; &nbsp;Previous post</span> <span class="link-to-post__title">感知器</span> </a></div></article></main><footer class="blog-footer content-wrapper"><p>&copy; <span class="full-year"></span> Liu-Cheng Xu</footer><script src="/blog-cn/assets/js/scripts.js"></script> <script type="text/javascript" charset="utf-8"> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments) },i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-73260325-3', 'auto'); ga('send', 'pageview'); </script>

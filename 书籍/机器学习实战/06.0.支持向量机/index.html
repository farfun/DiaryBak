



<!DOCTYPE html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Nothing is impossible">
      
      
        <link rel="canonical" href="https://1007530194.github.io/Diary/书籍/机器学习实战/06.0.支持向量机/">
      
      
        <meta name="author" content="NiuLiangtao">
      
      
        <meta name="lang:clipboard.copy" content="复制">
      
        <meta name="lang:clipboard.copied" content="已复制">
      
        <meta name="lang:search.language" content="jp">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="没有找到符合条件的结果">
      
        <meta name="lang:search.result.one" content="找到 1 个符合条件的结果">
      
        <meta name="lang:search.result.other" content="# 个符合条件的结果">
      
        <meta name="lang:search.tokenizer" content="[\uff0c\u3002]+">
      
      <link rel="shortcut icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-0.17.3, mkdocs-material-2.7.0">
    
    
      
        <title>6.支持向量机</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/application.78aab2dc.css">
      
        <link rel="stylesheet" href="../../../assets/stylesheets/application-palette.6079476c.css">
      
    
    
      <script src="../../../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <a href="#6" tabindex="1" class="md-skip">
        跳转至
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://1007530194.github.io/Diary/" title="Blog of NiuLiangtao" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                Blog of NiuLiangtao
              </span>
              <span class="md-header-nav__topic">
                6.支持向量机
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            键入以开始搜索
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/1007530194/Diary" title="前往 Github 仓库" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      1007530194/Diary
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../.." title="Home" class="md-tabs__link">
          Home
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../" title="书籍" class="md-tabs__link md-tabs__link--active">
          书籍
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../学习/" title="学习" class="md-tabs__link">
          学习
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../工具/About/" title="工具" class="md-tabs__link">
          工具
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../推荐/个人理解的/" title="推荐" class="md-tabs__link">
          推荐
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../文章/" title="文章" class="md-tabs__link">
          文章
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../日常/AboutMe/" title="日常" class="md-tabs__link">
          日常
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <span class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </span>
    Blog of NiuLiangtao
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/1007530194/Diary" title="前往 Github 仓库" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      1007530194/Diary
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../../../ToDo/" title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Home
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Home
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Nothing/" title="Nothing" class="md-nav__link">
      Nothing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../ToDo/" title="要做的" class="md-nav__link">
      要做的
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" checked>
    
    <label class="md-nav__link" for="nav-3">
      书籍
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        书籍
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../" title="Home" class="md-nav__link">
      Home
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-2" type="checkbox" id="nav-3-2" checked>
    
    <label class="md-nav__link" for="nav-3-2">
      机器学习实战
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-2">
        机器学习实战
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../00naive-bayes-discuss/" title="naive-bayes-discuss" class="md-nav__link">
      naive-bayes-discuss
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../01.机器学习基础/" title="1.机器学习基础" class="md-nav__link">
      1.机器学习基础
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../02.k-近邻算法/" title="2.k-近邻算法" class="md-nav__link">
      2.k-近邻算法
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../03.决策树/" title="3.决策树" class="md-nav__link">
      3.决策树
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../04.朴素贝叶斯/" title="4.朴素贝叶斯" class="md-nav__link">
      4.朴素贝叶斯
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../05.Logistic回归/" title="5.Logistic回归" class="md-nav__link">
      5.Logistic回归
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        6.支持向量机
      </label>
    
    <a href="./" title="6.支持向量机" class="md-nav__link md-nav__link--active">
      6.支持向量机
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">目录</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" title="支持向量机 概述" class="md-nav__link">
    支持向量机 概述
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" title="支持向量机 场景" class="md-nav__link">
    支持向量机 场景
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" title="支持向量机 原理" class="md-nav__link">
    支持向量机 原理
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#svm" title="SVM 工作原理" class="md-nav__link">
    SVM 工作原理
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" title="寻找最大间隔" class="md-nav__link">
    寻找最大间隔
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_5" title="为什么寻找最大间隔" class="md-nav__link">
    为什么寻找最大间隔
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" title="怎么寻找最大间隔" class="md-nav__link">
    怎么寻找最大间隔
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smo" title="SMO 高效优化算法" class="md-nav__link">
    SMO 高效优化算法
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#svm_1" title="SVM 开发流程" class="md-nav__link">
    SVM 开发流程
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#svm_2" title="SVM 算法特点" class="md-nav__link">
    SVM 算法特点
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" title="课本案例（无核函数）" class="md-nav__link">
    课本案例（无核函数）
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_8" title="项目概述" class="md-nav__link">
    项目概述
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_9" title="开发流程" class="md-nav__link">
    开发流程
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kernel" title="核函数(kernel) 使用" class="md-nav__link">
    核函数(kernel) 使用
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_10" title="项目案例: 手写数字识别的优化（有核函数）" class="md-nav__link">
    项目案例: 手写数字识别的优化（有核函数）
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_11" title="项目概述" class="md-nav__link">
    项目概述
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_12" title="开发流程" class="md-nav__link">
    开发流程
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../06.1.支持向量机的几个通俗理解/" title="06.1.支持向量机的几个通俗理解" class="md-nav__link">
      06.1.支持向量机的几个通俗理解
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../07.集成方法-随机森林和AdaBoost/" title="07.集成方法 随机森林和AdaBoost" class="md-nav__link">
      07.集成方法 随机森林和AdaBoost
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../08.预测数值型数据-回归/" title="08.预测数值型数据 回归" class="md-nav__link">
      08.预测数值型数据 回归
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../09.树回归/" title="09.树回归" class="md-nav__link">
      09.树回归
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../10.k-means聚类/" title="10.k means聚类" class="md-nav__link">
      10.k means聚类
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../11.使用Apriori算法进行关联分析/" title="11.使用Apriori算法进行关联分析" class="md-nav__link">
      11.使用Apriori算法进行关联分析
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../12.使用FP-growth算法来高效发现频繁项集/" title="12.使用FP growth算法来高效发现频繁项集" class="md-nav__link">
      12.使用FP growth算法来高效发现频繁项集
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../13.利用PCA来简化数据/" title="13.利用PCA来简化数据" class="md-nav__link">
      13.利用PCA来简化数据
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../14.利用SVD简化数据/" title="14.利用SVD简化数据" class="md-nav__link">
      14.利用SVD简化数据
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../15.大数据与MapReduce/" title="15.大数据与MapReduce" class="md-nav__link">
      15.大数据与MapReduce
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../16.推荐系统/" title="16.推荐系统" class="md-nav__link">
      16.推荐系统
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-3" type="checkbox" id="nav-3-3">
    
    <label class="md-nav__link" for="nav-3-3">
      深度学习
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-3">
        深度学习
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../深度学习/DeepLearning/" title="DeepLearning" class="md-nav__link">
      DeepLearning
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      学习
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        学习
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/" title="Home" class="md-nav__link">
      Home
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-2" type="checkbox" id="nav-4-2">
    
    <label class="md-nav__link" for="nav-4-2">
      tensorflow
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-2">
        tensorflow
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/tensorflow/如何选择优化器 optimizer/" title="如何选择优化器 optimizer" class="md-nav__link">
      如何选择优化器 optimizer
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-3" type="checkbox" id="nav-4-3">
    
    <label class="md-nav__link" for="nav-4-3">
      深度学习
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-3">
        深度学习
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/深度学习/主成分分析-2/" title="主成分分析 2" class="md-nav__link">
      主成分分析 2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/深度学习/主成分分析/" title="主成分分析" class="md-nav__link">
      主成分分析
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/深度学习/最小二乘法/" title="最小二乘法" class="md-nav__link">
      最小二乘法
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/深度学习/矩阵分解/" title="矩阵分解" class="md-nav__link">
      矩阵分解
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/深度学习/矩阵求导/" title="矩阵求导" class="md-nav__link">
      矩阵求导
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-4" type="checkbox" id="nav-4-4">
    
    <label class="md-nav__link" for="nav-4-4">
      转载
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-4">
        转载
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-4-1" type="checkbox" id="nav-4-4-1">
    
    <label class="md-nav__link" for="nav-4-4-1">
      cs231n-ch
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-4-4-1">
        cs231n-ch
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/转载/cs231n-ch/ch-assignment2_google_cloud/" title="Ch assignment2 google cloud" class="md-nav__link">
      Ch assignment2 google cloud
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/转载/cs231n-ch/ch-aws-tutorial/" title="Ch aws tutorial" class="md-nav__link">
      Ch aws tutorial
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/转载/cs231n-ch/ch-classification/" title="Ch classification" class="md-nav__link">
      Ch classification
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/转载/cs231n-ch/ch-convnet-tips/" title="Ch convnet tips" class="md-nav__link">
      Ch convnet tips
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/转载/cs231n-ch/ch-convolutional-networks/" title="Ch convolutional networks" class="md-nav__link">
      Ch convolutional networks
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/转载/cs231n-ch/ch-google_cloud_tutorial/" title="Ch google cloud tutorial" class="md-nav__link">
      Ch google cloud tutorial
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/转载/cs231n-ch/ch-ipython-tutorial/" title="Ch ipython tutorial" class="md-nav__link">
      Ch ipython tutorial
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/转载/cs231n-ch/ch-linear-classify/" title="Ch linear classify" class="md-nav__link">
      Ch linear classify
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/转载/cs231n-ch/ch-neural-networks-1/" title="Ch neural networks 1" class="md-nav__link">
      Ch neural networks 1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/转载/cs231n-ch/ch-neural-networks-2/" title="Ch neural networks 2" class="md-nav__link">
      Ch neural networks 2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/转载/cs231n-ch/ch-neural-networks-3/" title="Ch neural networks 3" class="md-nav__link">
      Ch neural networks 3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/转载/cs231n-ch/ch-neural-networks-case-study/" title="Ch neural networks case study" class="md-nav__link">
      Ch neural networks case study
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/转载/cs231n-ch/ch-optimization-1/" title="Ch optimization 1" class="md-nav__link">
      Ch optimization 1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/转载/cs231n-ch/ch-optimization-2/" title="Ch optimization 2" class="md-nav__link">
      Ch optimization 2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/转载/cs231n-ch/ch-overview/" title="Ch overview" class="md-nav__link">
      Ch overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/转载/cs231n-ch/ch-poster/" title="Ch poster" class="md-nav__link">
      Ch poster
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/转载/cs231n-ch/ch-python-numpy-tutorial/" title="Ch python numpy tutorial" class="md-nav__link">
      Ch python numpy tutorial
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/转载/cs231n-ch/ch-Readme/" title="ch Readme" class="md-nav__link">
      ch Readme
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/转载/cs231n-ch/ch-transfer-learning/" title="Ch transfer learning" class="md-nav__link">
      Ch transfer learning
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/转载/cs231n-ch/ch-understanding-cnn/" title="Ch understanding cnn" class="md-nav__link">
      Ch understanding cnn
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/转载/cs231n-ch/terminal-tutorial/" title="Terminal tutorial" class="md-nav__link">
      Terminal tutorial
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-4-2" type="checkbox" id="nav-4-4-2">
    
    <label class="md-nav__link" for="nav-4-4-2">
      cs231n-en
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-4-4-2">
        cs231n-en
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/转载/cs231n-en/en-assignment2_google_cloud/" title="En assignment2 google cloud" class="md-nav__link">
      En assignment2 google cloud
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/转载/cs231n-en/en-aws-tutorial/" title="En aws tutorial" class="md-nav__link">
      En aws tutorial
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/转载/cs231n-en/en-classification/" title="En classification" class="md-nav__link">
      En classification
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/转载/cs231n-en/en-convnet-tips/" title="En convnet tips" class="md-nav__link">
      En convnet tips
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/转载/cs231n-en/en-convolutional-networks/" title="En convolutional networks" class="md-nav__link">
      En convolutional networks
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/转载/cs231n-en/en-google_cloud_tutorial/" title="En google cloud tutorial" class="md-nav__link">
      En google cloud tutorial
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/转载/cs231n-en/en-ipython-tutorial/" title="En ipython tutorial" class="md-nav__link">
      En ipython tutorial
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/转载/cs231n-en/en-linear-classify/" title="En linear classify" class="md-nav__link">
      En linear classify
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/转载/cs231n-en/en-neural-networks-1/" title="En neural networks 1" class="md-nav__link">
      En neural networks 1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/转载/cs231n-en/en-neural-networks-2/" title="En neural networks 2" class="md-nav__link">
      En neural networks 2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/转载/cs231n-en/en-neural-networks-3/" title="En neural networks 3" class="md-nav__link">
      En neural networks 3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/转载/cs231n-en/en-neural-networks-case-study/" title="En neural networks case study" class="md-nav__link">
      En neural networks case study
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/转载/cs231n-en/en-optimization-1/" title="En optimization 1" class="md-nav__link">
      En optimization 1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/转载/cs231n-en/en-optimization-2/" title="En optimization 2" class="md-nav__link">
      En optimization 2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/转载/cs231n-en/en-overview/" title="En overview" class="md-nav__link">
      En overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/转载/cs231n-en/en-poster/" title="En poster" class="md-nav__link">
      En poster
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/转载/cs231n-en/en-python-numpy-tutorial/" title="En python numpy tutorial" class="md-nav__link">
      En python numpy tutorial
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/转载/cs231n-en/en-Readme/" title="en Readme" class="md-nav__link">
      en Readme
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/转载/cs231n-en/en-terminal-tutorial/" title="En terminal tutorial" class="md-nav__link">
      En terminal tutorial
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/转载/cs231n-en/en-transfer-learning/" title="En transfer learning" class="md-nav__link">
      En transfer learning
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/转载/cs231n-en/en-understanding-cnn/" title="En understanding cnn" class="md-nav__link">
      En understanding cnn
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-4-3" type="checkbox" id="nav-4-4-3">
    
    <label class="md-nav__link" for="nav-4-4-3">
      example
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-4-4-3">
        example
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/转载/example/a-web-crawer-with-a-asyncio-coroutines-1/" title="A web crawer with a asyncio coroutines 1" class="md-nav__link">
      A web crawer with a asyncio coroutines 1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/转载/example/a-web-crawer-with-a-asyncio-coroutines-2/" title="A web crawer with a asyncio coroutines 2" class="md-nav__link">
      A web crawer with a asyncio coroutines 2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/转载/example/bias-variance/" title="Bias variance" class="md-nav__link">
      Bias variance
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/转载/example/bitcoin-explained-1/" title="Bitcoin explained 1" class="md-nav__link">
      Bitcoin explained 1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/转载/example/dive-into-gradient-decent/" title="Dive into gradient decent" class="md-nav__link">
      Dive into gradient decent
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/转载/example/ethereum-ultimate-guide/" title="Ethereum ultimate guide" class="md-nav__link">
      Ethereum ultimate guide
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/转载/example/fork-exec-source/" title="Fork exec source" class="md-nav__link">
      Fork exec source
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/转载/example/latex语法/" title="Latex语法" class="md-nav__link">
      Latex语法
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/转载/example/latex语法1/" title="Latex语法1" class="md-nav__link">
      Latex语法1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/转载/example/nosql-in-python/" title="Nosql in python" class="md-nav__link">
      Nosql in python
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/转载/example/perceptron/" title="Perceptron" class="md-nav__link">
      Perceptron
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/转载/example/quick-latex/" title="Quick latex" class="md-nav__link">
      Quick latex
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/转载/example/tendermint/" title="Tendermint" class="md-nav__link">
      Tendermint
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-4-4" type="checkbox" id="nav-4-4-4">
    
    <label class="md-nav__link" for="nav-4-4-4">
      example2
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-4-4-4">
        example2
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/转载/example2/arrays-similar/" title="Arrays similar" class="md-nav__link">
      Arrays similar
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/转载/example2/baidu-ife-1-HTML&CSS/" title="baidu ife 1 HTML&CSS" class="md-nav__link">
      baidu ife 1 HTML&CSS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/转载/example2/baidu-ife-2-javascript/" title="Baidu ife 2 javascript" class="md-nav__link">
      Baidu ife 2 javascript
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/转载/example2/create-my-blog-with-jekyll/" title="Create my blog with jekyll" class="md-nav__link">
      Create my blog with jekyll
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/转载/example2/front-end-tools/" title="Front end tools" class="md-nav__link">
      Front end tools
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/转载/example2/git-clone-not-master-branch/" title="Git clone not master branch" class="md-nav__link">
      Git clone not master branch
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/转载/example2/History-API/" title="History API" class="md-nav__link">
      History API
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/转载/example2/how-to-use-babel/" title="How to use babel" class="md-nav__link">
      How to use babel
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/转载/example2/how-to-write-a-count-down/" title="How to write a count down" class="md-nav__link">
      How to write a count down
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/转载/example2/JavaScript-closure/" title="JavaScript closure" class="md-nav__link">
      JavaScript closure
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/转载/example2/JavaScript-function/" title="JavaScript function" class="md-nav__link">
      JavaScript function
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/转载/example2/JavaScript-good-parts-note1/" title="JavaScript good parts note1" class="md-nav__link">
      JavaScript good parts note1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/转载/example2/JavaScript-good-parts-note2/" title="JavaScript good parts note2" class="md-nav__link">
      JavaScript good parts note2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/转载/example2/JavaScript-good-parts-note3/" title="JavaScript good parts note3" class="md-nav__link">
      JavaScript good parts note3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/转载/example2/JavaScript-Net/" title="JavaScript Net" class="md-nav__link">
      JavaScript Net
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/转载/example2/JavaScript-Object-Oriented/" title="JavaScript Object Oriented" class="md-nav__link">
      JavaScript Object Oriented
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/转载/example2/JavaScript-this/" title="JavaScript this" class="md-nav__link">
      JavaScript this
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/转载/example2/jekyll-theme-version-2.0/" title="Jekyll theme version 2.0" class="md-nav__link">
      Jekyll theme version 2.0
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/转载/example2/js-create-file-and-download/" title="Js create file and download" class="md-nav__link">
      Js create file and download
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/转载/example2/low-IE-click-empty-block-bug/" title="low IE click empty block bug" class="md-nav__link">
      low IE click empty block bug
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/转载/example2/regular-expression-group/" title="Regular expression group" class="md-nav__link">
      Regular expression group
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/转载/example2/scope/" title="Scope" class="md-nav__link">
      Scope
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/转载/example2/shuffle-algorithm/" title="Shuffle algorithm" class="md-nav__link">
      Shuffle algorithm
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/转载/example2/sublimeLinter/" title="sublimeLinter" class="md-nav__link">
      sublimeLinter
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/转载/example2/Syncing-a-fork/" title="Syncing a fork" class="md-nav__link">
      Syncing a fork
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/转载/example2/teach-girlfriend-html-css/" title="Teach girlfriend html css" class="md-nav__link">
      Teach girlfriend html css
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/转载/example2/web-app/" title="Web app" class="md-nav__link">
      Web app
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../学习/转载/example2/weinre/" title="Weinre" class="md-nav__link">
      Weinre
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      工具
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        工具
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../工具/About/" title="About" class="md-nav__link">
      About
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../工具/Cheatsheet/" title="Cheatsheet" class="md-nav__link">
      Cheatsheet
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../工具/" title="Home" class="md-nav__link">
      Home
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../工具/shell显示时间/" title="Shell显示时间" class="md-nav__link">
      Shell显示时间
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-5" type="checkbox" id="nav-5-5">
    
    <label class="md-nav__link" for="nav-5-5">
      常用工具
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-5-5">
        常用工具
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../工具/常用工具/10分钟上手Latex/" title="10分钟上手Latex" class="md-nav__link">
      10分钟上手Latex
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../工具/常用工具/10分钟上手Pandas/" title="10分钟上手Pandas" class="md-nav__link">
      10分钟上手Pandas
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../工具/常用工具/10分钟上手Python/" title="10分钟上手Python" class="md-nav__link">
      10分钟上手Python
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      推荐
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        推荐
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../推荐/个人理解的/" title="个人理解的" class="md-nav__link">
      个人理解的
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-2" type="checkbox" id="nav-6-2">
    
    <label class="md-nav__link" for="nav-6-2">
      推荐框架
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-2">
        推荐框架
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../推荐/推荐框架/" title="Home" class="md-nav__link">
      Home
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../推荐/推荐框架/LibRec/" title="LibRec" class="md-nav__link">
      LibRec
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-2-3" type="checkbox" id="nav-6-2-3">
    
    <label class="md-nav__link" for="nav-6-2-3">
      LibRec介绍文档
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-6-2-3">
        LibRec介绍文档
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../推荐/推荐框架/LibRec介绍文档/AlgorithmList/" title="AlgorithmList" class="md-nav__link">
      AlgorithmList
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../推荐/推荐框架/LibRec介绍文档/CLIWalkthrough/" title="CLIWalkthrough" class="md-nav__link">
      CLIWalkthrough
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../推荐/推荐框架/LibRec介绍文档/ConfigurationList/" title="ConfigurationList" class="md-nav__link">
      ConfigurationList
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../推荐/推荐框架/LibRec介绍文档/Context/" title="Context" class="md-nav__link">
      Context
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../推荐/推荐框架/LibRec介绍文档/DataFileFormat/" title="DataFileFormat" class="md-nav__link">
      DataFileFormat
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../推荐/推荐框架/LibRec介绍文档/DataModel/" title="DataModel" class="md-nav__link">
      DataModel
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../推荐/推荐框架/LibRec介绍文档/Evaluator/" title="Evaluator" class="md-nav__link">
      Evaluator
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../推荐/推荐框架/LibRec介绍文档/FilmTrust/" title="FilmTrust" class="md-nav__link">
      FilmTrust
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../推荐/推荐框架/LibRec介绍文档/Filter/" title="Filter" class="md-nav__link">
      Filter
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../推荐/推荐框架/LibRec介绍文档/Introduction/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../推荐/推荐框架/LibRec介绍文档/LibrecDocument/" title="LibrecDocument" class="md-nav__link">
      LibrecDocument
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../推荐/推荐框架/LibRec介绍文档/Recommender/" title="Recommender" class="md-nav__link">
      Recommender
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      文章
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        文章
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../文章/" title="Home" class="md-nav__link">
      Home
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8">
    
    <label class="md-nav__link" for="nav-8">
      日常
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        日常
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../日常/AboutMe/" title="AboutMe" class="md-nav__link">
      AboutMe
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../日常/" title="Home" class="md-nav__link">
      Home
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-3" type="checkbox" id="nav-8-3">
    
    <label class="md-nav__link" for="nav-8-3">
      test
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-8-3">
        test
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../日常/test/testtest/" title="Testtest" class="md-nav__link">
      Testtest
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">目录</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" title="支持向量机 概述" class="md-nav__link">
    支持向量机 概述
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" title="支持向量机 场景" class="md-nav__link">
    支持向量机 场景
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" title="支持向量机 原理" class="md-nav__link">
    支持向量机 原理
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#svm" title="SVM 工作原理" class="md-nav__link">
    SVM 工作原理
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" title="寻找最大间隔" class="md-nav__link">
    寻找最大间隔
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_5" title="为什么寻找最大间隔" class="md-nav__link">
    为什么寻找最大间隔
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" title="怎么寻找最大间隔" class="md-nav__link">
    怎么寻找最大间隔
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smo" title="SMO 高效优化算法" class="md-nav__link">
    SMO 高效优化算法
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#svm_1" title="SVM 开发流程" class="md-nav__link">
    SVM 开发流程
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#svm_2" title="SVM 算法特点" class="md-nav__link">
    SVM 算法特点
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" title="课本案例（无核函数）" class="md-nav__link">
    课本案例（无核函数）
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_8" title="项目概述" class="md-nav__link">
    项目概述
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_9" title="开发流程" class="md-nav__link">
    开发流程
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kernel" title="核函数(kernel) 使用" class="md-nav__link">
    核函数(kernel) 使用
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_10" title="项目案例: 手写数字识别的优化（有核函数）" class="md-nav__link">
    项目案例: 手写数字识别的优化（有核函数）
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_11" title="项目概述" class="md-nav__link">
    项目概述
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_12" title="开发流程" class="md-nav__link">
    开发流程
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="6">第6章 支持向量机<a class="headerlink" href="#6" title="Permanent link">&para;</a></h1>
<h2 id="_1">支持向量机 概述<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<p>支持向量机(Support Vector Machines, SVM)：是一种机器学习算法。
* 支持向量(Support Vector)就是离分隔超平面最近的那些点。
* 机(Machine)就是表示一种算法，而不是表示机器。</p>
<h2 id="_2">支持向量机 场景<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h2>
<ul>
<li>要给左右两边的点进行分类</li>
<li>明显发现：选择D会比B、C分隔的效果要好很多。</li>
</ul>
<p><img alt="线性可分" src="../resources/6.SVM/SVM_3_linearly-separable.jpg" /></p>
<h2 id="_3">支持向量机 原理<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h2>
<h3 id="svm">SVM 工作原理<a class="headerlink" href="#svm" title="Permanent link">&para;</a></h3>
<p><img alt="k_2" src="../resources/6.SVM/k_2.jpg" title="k_2" /></p>
<p>对于上述的苹果和香蕉，我们想象为2种水果类型的炸弹。（保证距离最近的炸弹，距离它们最远）</p>
<ol>
<li>寻找最大分类间距</li>
<li>
<p>转而通过拉格朗日函数求优化的问题</p>
</li>
<li>
<p>数据可以通过画一条直线就可以将它们完全分开，这组数据叫<code>线性可分(linearly separable)</code>数据，而这条分隔直线称为<code>分隔超平面(separating hyperplane)</code>。</p>
</li>
<li>如果数据集上升到1024维呢？那么需要1023维来分隔数据集，也就说需要N-1维的对象来分隔，这个对象叫做<code>超平面(hyperlane)</code>，也就是分类的决策边界。</li>
</ol>
<p><img alt="分隔超平面" src="../resources/6.SVM/SVM_2_separating-hyperplane.jpg" /></p>
<h3 id="_4">寻找最大间隔<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h3>
<h4 id="_5">为什么寻找最大间隔<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span>摘录地址：http://slideplayer.com/slide/8610144  (第12条信息)
Support Vector Machines: Slide 12 Copyright © 2001, 2003, Andrew W. Moore Why Maximum Margin? 
denotes +1 denotes -1 f(x,w,b) = sign(w. x - b) The maximum margin linear classifier is the linear classifier with the, um, maximum margin. 
This is the simplest kind of SVM (Called an LSVM) Support Vectors are those datapoints that the margin pushes up against 

1.Intuitively this feels safest. 
2.If we’ve made a small error in the location of the boundary (it’s been jolted in its perpendicular direction) this gives us least chance of causing a misclassification. 
3.CV is easy since the model is immune to removal of any non-support-vector datapoints. 
4.There’s some theory that this is a good thing. 
5.Empirically it works very very well. 

* * *

1. 直觉上是安全的
2. 如果我们在边界的位置发生了一个小错误（它在垂直方向上被颠倒），这给我们最小的错误分类机会。
3. CV（Computer Vision 计算机视觉 - 这缩写看着可怕）很容易，因为该模型对任何非支持向量数据点的去除是免疫的。
4. 有一些理论，这是一件好事。
5. 通常它的工作非常好。
</pre></div>

<h4 id="_6">怎么寻找最大间隔<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h4>
<blockquote>
<p>点到超平面的距离</p>
</blockquote>
<ul>
<li>分隔超平面<code>函数间距</code>: $ y(x)=w^Tx+b $</li>
<li>分类的结果： $ f(x)=sign(w^Tx+b) $  (sign表示符号函数，&gt;0为1，&lt;0为-1，=0为0) </li>
<li>修改点到超平面的 <code>几何间距</code> :  $ d(x)=\frac{(w^Tx+b)}{\lVert w \rVert} $  （ <span><span class="MathJax_Preview">\lVert w \rVert</span><script type="math/tex">\lVert w \rVert</script></span> 表示w矩阵的二范式=&gt;  <span><span class="MathJax_Preview">\sqrt{w*w^T}</span><script type="math/tex">\sqrt{w*w^T}</script></span>  , 点到超平面的距离也是类似的）  </li>
</ul>
<p><img alt="点到直线的几何距离" src="../resources/6.SVM/SVM_4_point2line-distance.jpg" /></p>
<blockquote>
<p>拉格朗日乘子法</p>
</blockquote>
<ul>
<li>类别标签用-1、1，是为了后期方便  $lable\bullet(w^Tx+b) $ 的标识和距离计算；如果  $ lable\bullet(w^Tx+b)&gt;0 $  表示预测正确，否则预测错误。</li>
<li>现在目标很明确，就是要找到<code>w</code>和<code>b</code>，因此我们必须要找到最小间隔的数据点，也就是前面所说的<code>支持向量</code>。<ul>
<li>也就说，让最小的距离取最大.(最小的距离：就是最小间隔的数据点；最大：就是最大间距，为了找出最优超平面--最终就是支持向量)</li>
<li>目标函数： $ arg: max \left( min[lable\bullet(w^Tx+b)]\bullet\frac{1}{\lVert w \rVert} \right) $ <ol>
<li>如果  $ lable*(w^Tx+b)&gt;0 $  表示预测正确，也称<code>函数间隔</code>， $ \lVert w \rVert $  可以理解为归一化，也称<code>几何间隔</code>。</li>
<li>令  <span><span class="MathJax_Preview">lable\bullet(w^Tx+b)&gt;=1</span><script type="math/tex">lable\bullet(w^Tx+b)>=1</script></span> ， 因为0～1之间，得到的点是存在误判的可能性，所以要保障  <span><span class="MathJax_Preview">min[lable\bullet(w^Tx+b)]=1</span><script type="math/tex">min[lable\bullet(w^Tx+b)]=1</script></span> ，才能更好降低噪音数据影响。</li>
<li>所以本质上是求  $arg: max_{关于w, b}  \frac{1}{ \lVert w \rVert } $ ；也就说，我们约束(前提)条件是:  <span><span class="MathJax_Preview">lable*(w^Tx+b)=1</span><script type="math/tex">lable*(w^Tx+b)=1</script></span> </li>
</ol>
</li>
</ul>
</li>
<li>新的目标函数求解：$ arg: max_{关于w, b}  \frac{1}{ \lVert w \rVert } $ <ul>
<li>=&gt; 就是求:  $arg: min_{关于w, b}  \lVert w \rVert  $  (求矩阵会比较麻烦，如果x只是  <span><span class="MathJax_Preview">\frac{1}{2}\bullet x^2</span><script type="math/tex">\frac{1}{2}\bullet x^2</script></span>  的偏导数，那么。。同样是求最小值)</li>
<li>=&gt; 就是求:  <span><span class="MathJax_Preview">arg: min_{关于w, b} (\frac{1}{2}\bullet \lVert w \rVert ^2)</span><script type="math/tex">arg: min_{关于w, b} (\frac{1}{2}\bullet \lVert w \rVert ^2)</script></span>  (二次函数求导，求极值，平方也方便计算)</li>
<li>本质上就是求线性不等式的二次优化问题(求分隔超平面，等价于求解相应的凸二次规划问题)</li>
</ul>
</li>
<li>通过拉格朗日乘子法，求二次优化问题<ul>
<li>假设需要求极值的目标函数 (objective function) 为 f(x,y)，限制条件为 φ(x,y)=M  # M=1</li>
<li>设g(x,y)=M-φ(x,y)   # 临时φ(x,y)表示下文中  <span><span class="MathJax_Preview">label\bullet(w^Tx+b)</span><script type="math/tex">label\bullet(w^Tx+b)</script></span> </li>
<li>定义一个新函数: F(x,y,λ)=f(x,y)+λg(x,y)</li>
<li>a为λ（a&gt;=0），代表要引入的拉格朗日乘子(Lagrange multiplier)</li>
<li>那么：  <span><span class="MathJax_Preview">L(w,b,\alpha)=\frac{1}{2} \bullet  \lVert w \rVert ^2 + \sum_{i=1}^{n} \alpha_i \bullet [1 - label \bullet (w^Tx+b)]</span><script type="math/tex">L(w,b,\alpha)=\frac{1}{2} \bullet  \lVert w \rVert ^2 + \sum_{i=1}^{n} \alpha_i \bullet [1 - label \bullet (w^Tx+b)]</script></span> </li>
<li>因为： <span><span class="MathJax_Preview">label\bullet(w^Tx+b)&gt;=1, \alpha&gt;=0</span><script type="math/tex">label\bullet(w^Tx+b)>=1, \alpha>=0</script></span>  , 所以  <span><span class="MathJax_Preview">\alpha\bullet[1-label\bullet(w^Tx+b)]&lt;=0</span><script type="math/tex">\alpha\bullet[1-label\bullet(w^Tx+b)]<=0</script></span>  ,  <span><span class="MathJax_Preview">\sum_{i=1}^{n} \alpha_i \bullet [1-label*(w^Tx+b)]&lt;=0</span><script type="math/tex">\sum_{i=1}^{n} \alpha_i \bullet [1-label*(w^Tx+b)]<=0</script></span>  </li>
<li>当  <span><span class="MathJax_Preview">label\bullet(w^Tx+b)&gt;1</span><script type="math/tex">label\bullet(w^Tx+b)>1</script></span>  则  <span><span class="MathJax_Preview">\alpha=0</span><script type="math/tex">\alpha=0</script></span>  ，表示该点为<font color=red>非支持向量</font></li>
<li>相当于求解：  <span><span class="MathJax_Preview">max_{关于\alpha} L(w,b,\alpha) = \frac{1}{2} \bullet \lVert w \rVert ^2</span><script type="math/tex">max_{关于\alpha} L(w,b,\alpha) = \frac{1}{2} \bullet \lVert w \rVert ^2</script></span>  </li>
<li>如果求：  <span><span class="MathJax_Preview">min_{关于w, b} \frac{1}{2} * \lVert w \rVert ^2</span><script type="math/tex">min_{关于w, b} \frac{1}{2} * \lVert w \rVert ^2</script></span>  , 也就是要求：  <span><span class="MathJax_Preview">min_{关于w, b} \left( max_{关于\alpha} L(w,b,\alpha)\right)</span><script type="math/tex">min_{关于w, b} \left( max_{关于\alpha} L(w,b,\alpha)\right)</script></span>  </li>
</ul>
</li>
<li>现在转化到对偶问题的求解<ul>
<li>$min_{关于w, b} \left(max_{关于\alpha} L(w,b,\alpha) \right) $  &gt;=  $max_{关于\alpha} \left(min_{关于w, b} L(w,b,\alpha) \right) $  </li>
<li>现在分2步</li>
<li>先求：  <span><span class="MathJax_Preview">min_{关于w, b} L(w,b,\alpha)=\frac{1}{2} \bullet  \lVert w \rVert ^2 + \sum_{i=1}^{n} \alpha_i \bullet [1 - label \bullet (w^Tx+b)]</span><script type="math/tex">min_{关于w, b} L(w,b,\alpha)=\frac{1}{2} \bullet  \lVert w \rVert ^2 + \sum_{i=1}^{n} \alpha_i \bullet [1 - label \bullet (w^Tx+b)]</script></span> </li>
<li>就是求<code>L(w,b,a)</code>关于[w, b]的偏导数, 得到<code>w和b的值</code>，并化简为：<code>L和a的方程</code>。</li>
<li>参考： 如果公式推导还是不懂，也可以参考《统计学习方法》李航-P103&lt;学习的对偶算法&gt;
<img alt="计算拉格朗日函数的对偶函数" src="../resources/6.SVM/SVM_5_Lagrangemultiplier.png" /></li>
</ul>
</li>
<li>终于得到课本上的公式：  $max_{关于\alpha} \left( \sum_{i=1}^{m} \alpha_i - \frac{1}{2} \sum_{i, j=1}^{m} label_i·label_j·\alpha_i·\alpha_j·<x_i, x_j> \right) $ </li>
<li>约束条件：  <span><span class="MathJax_Preview">a&gt;=0</span><script type="math/tex">a>=0</script></span>  并且  <span><span class="MathJax_Preview">\sum_{i=1}^{m} a_i·label_i=0</span><script type="math/tex">\sum_{i=1}^{m} a_i·label_i=0</script></span> </li>
</ul>
<blockquote>
<p>松弛变量(slack variable)</p>
</blockquote>
<p>参考地址：<a href="http://blog.csdn.net/wusecaiyun/article/details/49659183">http://blog.csdn.net/wusecaiyun/article/details/49659183</a></p>
<p><img alt="松弛变量公式" src="../resources/6.SVM/SVM_松弛变量.jpg" /></p>
<ul>
<li>我们知道几乎所有的数据都不那么干净, 通过引入松弛变量来 <code>允许数据点可以处于分隔面错误的一侧</code>。</li>
<li>约束条件：  <span><span class="MathJax_Preview">C&gt;=a&gt;=0</span><script type="math/tex">C>=a>=0</script></span>  并且  <span><span class="MathJax_Preview">\sum_{i=1}^{m} a_i·label_i=0</span><script type="math/tex">\sum_{i=1}^{m} a_i·label_i=0</script></span> </li>
<li>总的来说：<ul>
<li><img alt="松弛变量" src="../resources/6.SVM/松弛变量.png" /> 表示 <code>松弛变量</code></li>
<li>常量C是 <code>惩罚因子</code>, 表示离群点的权重（用于控制“最大化间隔”和“保证大部分点的函数间隔小于1.0” ）<ul>
<li><span><span class="MathJax_Preview">label*(w^Tx+b) &gt; 1</span><script type="math/tex">label*(w^Tx+b) > 1</script></span>  and alpha = 0 (在边界外，就是非支持向量)</li>
<li><span><span class="MathJax_Preview">label*(w^Tx+b) = 1</span><script type="math/tex">label*(w^Tx+b) = 1</script></span>  and 0&lt; alpha &lt; C (在分割超平面上，就支持向量)</li>
<li><span><span class="MathJax_Preview">label*(w^Tx+b) &lt; 1</span><script type="math/tex">label*(w^Tx+b) < 1</script></span>  and alpha = C (在分割超平面内，是误差点 -&gt; C表示它该受到的惩罚因子程度)</li>
<li>参考地址：<a href="https://www.zhihu.com/question/48351234/answer/110486455">https://www.zhihu.com/question/48351234/answer/110486455</a></li>
</ul>
</li>
<li>C值越大，表示离群点影响越大，就越容易过度拟合；反之有可能欠拟合。</li>
<li>我们看到，目标函数控制了离群点的数目和程度，使大部分样本点仍然遵守限制条件。</li>
<li>例如：正类有10000个样本，而负类只给了100个（C越大表示100个负样本的影响越大，就会出现过度拟合，所以C决定了负样本对模型拟合程度的影响！，C就是一个非常关键的优化点！）</li>
</ul>
</li>
<li>这一结论十分直接，SVM中的主要工作就是要求解 alpha.</li>
</ul>
<h3 id="smo">SMO 高效优化算法<a class="headerlink" href="#smo" title="Permanent link">&para;</a></h3>
<ul>
<li>SVM有很多种实现，最流行的一种实现是： <code>序列最小优化(Sequential Minimal Optimization, SMO)算法</code>。</li>
<li>下面还会介绍一种称为 <code>核函数(kernel)</code> 的方式将SVM扩展到更多数据集上。</li>
<li>注意：<code>SVM几何含义比较直观，但其算法实现较复杂，牵扯大量数学公式的推导。</code></li>
</ul>
<blockquote>
<p>序列最小优化(Sequential Minimal Optimization, SMO)</p>
</blockquote>
<ul>
<li>创建作者：John Platt</li>
<li>创建时间：1996年</li>
<li>SMO用途：用于训练 SVM</li>
<li>SMO目标：求出一系列 alpha 和 b,一旦求出 alpha，就很容易计算出权重向量 w 并得到分隔超平面。</li>
<li>SMO思想：是将大优化问题分解为多个小优化问题来求解的。</li>
<li>SMO原理：每次循环选择两个 alpha 进行优化处理，一旦找出一对合适的 alpha，那么就增大一个同时减少一个。<ul>
<li>这里指的合适必须要符合一定的条件<ol>
<li>这两个 alpha 必须要在间隔边界之外</li>
<li>这两个 alpha 还没有进行过区间化处理或者不在边界上。</li>
</ol>
</li>
<li>之所以要同时改变2个 alpha；原因是我们有一个约束条件：  <span><span class="MathJax_Preview">\sum_{i=1}^{m} a_i·label_i=0</span><script type="math/tex">\sum_{i=1}^{m} a_i·label_i=0</script></span> ；如果只是修改一个 alpha，很可能导致约束条件失效。</li>
</ul>
</li>
</ul>
<blockquote>
<p>SMO 伪代码大致如下：</p>
</blockquote>
<div class="codehilite"><pre><span></span>创建一个 alpha 向量并将其初始化为0向量
当迭代次数小于最大迭代次数时(外循环)
    对数据集中的每个数据向量(内循环)：
        如果该数据向量可以被优化
            随机选择另外一个数据向量
            同时优化这两个向量
            如果两个向量都不能被优化，退出内循环
    如果所有向量都没被优化，增加迭代数目，继续下一次循环
</pre></div>

<h3 id="svm_1">SVM 开发流程<a class="headerlink" href="#svm_1" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span>收集数据：可以使用任意方法。
准备数据：需要数值型数据。
分析数据：有助于可视化分隔超平面。
训练算法：SVM的大部分时间都源自训练，该过程主要实现两个参数的调优。
测试算法：十分简单的计算过程就可以实现。
使用算法：几乎所有分类问题都可以使用SVM，值得一提的是，SVM本身是一个二类分类器，对多类问题应用SVM需要对代码做一些修改。
</pre></div>

<h3 id="svm_2">SVM 算法特点<a class="headerlink" href="#svm_2" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span>优点：泛化（由具体的、个别的扩大为一般的，就是说：模型训练完后的新样本）错误率低，计算开销不大，结果易理解。
缺点：对参数调节和核函数的选择敏感，原始分类器不加修改仅适合于处理二分类问题。
使用数据类型：数值型和标称型数据。
</pre></div>

<h3 id="_7">课本案例（无核函数）<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h3>
<h4 id="_8">项目概述<a class="headerlink" href="#_8" title="Permanent link">&para;</a></h4>
<p>对小规模数据点进行分类</p>
<h4 id="_9">开发流程<a class="headerlink" href="#_9" title="Permanent link">&para;</a></h4>
<blockquote>
<p>收集数据</p>
</blockquote>
<p>文本文件格式：</p>
<div class="codehilite"><pre><span></span><span class="mf">3.542485</span>    <span class="mf">1.977398</span>    <span class="o">-</span><span class="mi">1</span>
<span class="mf">3.018896</span>    <span class="mf">2.556416</span>    <span class="o">-</span><span class="mi">1</span>
<span class="mf">7.551510</span>    <span class="o">-</span><span class="mf">1.580030</span>   <span class="mi">1</span>
<span class="mf">2.114999</span>    <span class="o">-</span><span class="mf">0.004466</span>   <span class="o">-</span><span class="mi">1</span>
<span class="mf">8.127113</span>    <span class="mf">1.274372</span>    <span class="mi">1</span>
</pre></div>

<blockquote>
<p>准备数据</p>
</blockquote>
<div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">loadDataSet</span><span class="p">(</span><span class="n">fileName</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    对文件进行逐行解析，从而得到第行的类标签和整个特征矩阵</span>
<span class="sd">    Args:</span>
<span class="sd">        fileName 文件名</span>
<span class="sd">    Returns:</span>
<span class="sd">        dataMat  特征矩阵</span>
<span class="sd">        labelMat 类标签</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">dataMat</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">labelMat</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">fr</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">fileName</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">fr</span><span class="o">.</span><span class="n">readlines</span><span class="p">():</span>
        <span class="n">lineArr</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">dataMat</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">lineArr</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">lineArr</span><span class="p">[</span><span class="mi">1</span><span class="p">])])</span>
        <span class="n">labelMat</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">lineArr</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
    <span class="k">return</span> <span class="n">dataMat</span><span class="p">,</span> <span class="n">labelMat</span>
</pre></div>

<blockquote>
<p>分析数据: 无</p>
<p>训练算法</p>
</blockquote>
<div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">smoSimple</span><span class="p">(</span><span class="n">dataMatIn</span><span class="p">,</span> <span class="n">classLabels</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">toler</span><span class="p">,</span> <span class="n">maxIter</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;smoSimple</span>

<span class="sd">    Args:</span>
<span class="sd">        dataMatIn    特征集合</span>
<span class="sd">        classLabels  类别标签</span>
<span class="sd">        C   松弛变量(常量值)，允许有些数据点可以处于分隔面的错误一侧。</span>
<span class="sd">            控制最大化间隔和保证大部分的函数间隔小于1.0这两个目标的权重。</span>
<span class="sd">            可以通过调节该参数达到不同的结果。</span>
<span class="sd">        toler   容错率（是指在某个体系中能减小一些因素或选择对某个系统产生不稳定的概率。）</span>
<span class="sd">        maxIter 退出前最大的循环次数</span>
<span class="sd">    Returns:</span>
<span class="sd">        b       模型的常量值</span>
<span class="sd">        alphas  拉格朗日乘子</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">dataMatrix</span> <span class="o">=</span> <span class="n">mat</span><span class="p">(</span><span class="n">dataMatIn</span><span class="p">)</span>
    <span class="c1"># 矩阵转置 和 .T 一样的功能</span>
    <span class="n">labelMat</span> <span class="o">=</span> <span class="n">mat</span><span class="p">(</span><span class="n">classLabels</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
    <span class="n">m</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">shape</span><span class="p">(</span><span class="n">dataMatrix</span><span class="p">)</span>

    <span class="c1"># 初始化 b和alphas(alpha有点类似权重值。)</span>
    <span class="n">b</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">alphas</span> <span class="o">=</span> <span class="n">mat</span><span class="p">(</span><span class="n">zeros</span><span class="p">((</span><span class="n">m</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span>

    <span class="c1"># 没有任何alpha改变的情况下遍历数据的次数</span>
    <span class="nb">iter</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="p">(</span><span class="nb">iter</span> <span class="o">&lt;</span> <span class="n">maxIter</span><span class="p">):</span>
        <span class="c1"># w = calcWs(alphas, dataMatIn, classLabels)</span>
        <span class="c1"># print(&quot;w:&quot;, w)</span>

        <span class="c1"># 记录alpha是否已经进行优化，每次循环时设为0，然后再对整个集合顺序遍历</span>
        <span class="n">alphaPairsChanged</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
            <span class="c1"># print &#39;alphas=&#39;, alphas</span>
            <span class="c1"># print &#39;labelMat=&#39;, labelMat</span>
            <span class="c1"># print &#39;multiply(alphas, labelMat)=&#39;, multiply(alphas, labelMat)</span>
            <span class="c1"># 我们预测的类别 y[i] = w^Tx[i]+b; 其中因为 w = Σ(1~n) a[n]*lable[n]*x[n]</span>
            <span class="n">fXi</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">multiply</span><span class="p">(</span><span class="n">alphas</span><span class="p">,</span> <span class="n">labelMat</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="o">*</span><span class="p">(</span><span class="n">dataMatrix</span><span class="o">*</span><span class="n">dataMatrix</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">T</span><span class="p">))</span> <span class="o">+</span> <span class="n">b</span>
            <span class="c1"># 预测结果与真实结果比对，计算误差Ei</span>
            <span class="n">Ei</span> <span class="o">=</span> <span class="n">fXi</span> <span class="o">-</span> <span class="nb">float</span><span class="p">(</span><span class="n">labelMat</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

            <span class="c1"># 约束条件 (KKT条件是解决最优化问题的时用到的一种方法。我们这里提到的最优化问题通常是指对于给定的某一函数，求其在指定作用域上的全局最小值)</span>
            <span class="c1"># 0&lt;=alphas[i]&lt;=C，但由于0和C是边界值，我们无法进行优化，因为需要增加一个alphas和降低一个alphas。</span>
            <span class="c1"># 表示发生错误的概率：labelMat[i]*Ei 如果超出了 toler， 才需要优化。至于正负号，我们考虑绝对值就对了。</span>
            <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            # 检验训练样本(xi, yi)是否满足KKT条件</span>
<span class="sd">            yi*f(i) &gt;= 1 and alpha = 0 (outside the boundary)</span>
<span class="sd">            yi*f(i) == 1 and 0&lt;alpha&lt; C (on the boundary)</span>
<span class="sd">            yi*f(i) &lt;= 1 and alpha = C (between the boundary)</span>
<span class="sd">            &#39;&#39;&#39;</span>
            <span class="k">if</span> <span class="p">((</span><span class="n">labelMat</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">Ei</span> <span class="o">&lt;</span> <span class="o">-</span><span class="n">toler</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">C</span><span class="p">))</span> <span class="ow">or</span> <span class="p">((</span><span class="n">labelMat</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">Ei</span> <span class="o">&gt;</span> <span class="n">toler</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)):</span>

                <span class="c1"># 如果满足优化的条件，我们就随机选取非i的一个点，进行优化比较</span>
                <span class="n">j</span> <span class="o">=</span> <span class="n">selectJrand</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
                <span class="c1"># 预测j的结果</span>
                <span class="n">fXj</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">multiply</span><span class="p">(</span><span class="n">alphas</span><span class="p">,</span> <span class="n">labelMat</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="o">*</span><span class="p">(</span><span class="n">dataMatrix</span><span class="o">*</span><span class="n">dataMatrix</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">T</span><span class="p">))</span> <span class="o">+</span> <span class="n">b</span>
                <span class="n">Ej</span> <span class="o">=</span> <span class="n">fXj</span> <span class="o">-</span> <span class="nb">float</span><span class="p">(</span><span class="n">labelMat</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
                <span class="n">alphaIold</span> <span class="o">=</span> <span class="n">alphas</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="n">alphaJold</span> <span class="o">=</span> <span class="n">alphas</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

                <span class="c1"># L和H用于将alphas[j]调整到0-C之间。如果L==H，就不做任何改变，直接执行continue语句</span>
                <span class="c1"># labelMat[i] != labelMat[j] 表示异侧，就相减，否则是同侧，就相加。</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">labelMat</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="n">labelMat</span><span class="p">[</span><span class="n">j</span><span class="p">]):</span>
                    <span class="n">L</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">alphas</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">alphas</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                    <span class="n">H</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">C</span> <span class="o">+</span> <span class="n">alphas</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">alphas</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">L</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">alphas</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">alphas</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">C</span><span class="p">)</span>
                    <span class="n">H</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">alphas</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">alphas</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="c1"># 如果相同，就没发优化了</span>
                <span class="k">if</span> <span class="n">L</span> <span class="o">==</span> <span class="n">H</span><span class="p">:</span>
                    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;L==H&quot;</span><span class="p">)</span>
                    <span class="k">continue</span>

                <span class="c1"># eta是alphas[j]的最优修改量，如果eta==0，需要退出for循环的当前迭代过程</span>
                <span class="c1"># 参考《统计学习方法》李航-P125~P128&lt;序列最小最优化算法&gt;</span>
                <span class="n">eta</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">dataMatrix</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span><span class="o">*</span><span class="n">dataMatrix</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">T</span> <span class="o">-</span> <span class="n">dataMatrix</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span><span class="o">*</span><span class="n">dataMatrix</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">T</span> <span class="o">-</span> <span class="n">dataMatrix</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="p">:]</span><span class="o">*</span><span class="n">dataMatrix</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">T</span>
                <span class="k">if</span> <span class="n">eta</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;eta&gt;=0&quot;</span><span class="p">)</span>
                    <span class="k">continue</span>

                <span class="c1"># 计算出一个新的alphas[j]值</span>
                <span class="n">alphas</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-=</span> <span class="n">labelMat</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">Ei</span> <span class="o">-</span> <span class="n">Ej</span><span class="p">)</span><span class="o">/</span><span class="n">eta</span>
                <span class="c1"># 并使用辅助函数，以及L和H对其进行调整</span>
                <span class="n">alphas</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">clipAlpha</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">H</span><span class="p">,</span> <span class="n">L</span><span class="p">)</span>
                <span class="c1"># 检查alpha[j]是否只是轻微的改变，如果是的话，就退出for循环。</span>
                <span class="k">if</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">alphaJold</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.00001</span><span class="p">):</span>
                    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;j not moving enough&quot;</span><span class="p">)</span>
                    <span class="k">continue</span>
                <span class="c1"># 然后alphas[i]和alphas[j]同样进行改变，虽然改变的大小一样，但是改变的方向正好相反</span>
                <span class="n">alphas</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="n">labelMat</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">labelMat</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">alphaJold</span> <span class="o">-</span> <span class="n">alphas</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
                <span class="c1"># 在对alpha[i], alpha[j] 进行优化之后，给这两个alpha值设置一个常数b。</span>
                <span class="c1"># w= Σ[1~n] ai*yi*xi =&gt; b = yj- Σ[1~n] ai*yi(xi*xj)</span>
                <span class="c1"># 所以：  b1 - b = (y1-y) - Σ[1~n] yi*(a1-a)*(xi*x1)</span>
                <span class="c1"># 为什么减2遍？ 因为是 减去Σ[1~n]，正好2个变量i和j，所以减2遍</span>
                <span class="n">b1</span> <span class="o">=</span> <span class="n">b</span> <span class="o">-</span> <span class="n">Ei</span><span class="o">-</span> <span class="n">labelMat</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">alphaIold</span><span class="p">)</span><span class="o">*</span><span class="n">dataMatrix</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span><span class="o">*</span><span class="n">dataMatrix</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">T</span> <span class="o">-</span> <span class="n">labelMat</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">-</span><span class="n">alphaJold</span><span class="p">)</span><span class="o">*</span><span class="n">dataMatrix</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span><span class="o">*</span><span class="n">dataMatrix</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">T</span>
                <span class="n">b2</span> <span class="o">=</span> <span class="n">b</span> <span class="o">-</span> <span class="n">Ej</span><span class="o">-</span> <span class="n">labelMat</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">alphaIold</span><span class="p">)</span><span class="o">*</span><span class="n">dataMatrix</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span><span class="o">*</span><span class="n">dataMatrix</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">T</span> <span class="o">-</span> <span class="n">labelMat</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">-</span><span class="n">alphaJold</span><span class="p">)</span><span class="o">*</span><span class="n">dataMatrix</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="p">:]</span><span class="o">*</span><span class="n">dataMatrix</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">T</span>
                <span class="k">if</span> <span class="p">(</span><span class="mi">0</span> <span class="o">&lt;</span> <span class="n">alphas</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">C</span> <span class="o">&gt;</span> <span class="n">alphas</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span>
                    <span class="n">b</span> <span class="o">=</span> <span class="n">b1</span>
                <span class="k">elif</span> <span class="p">(</span><span class="mi">0</span> <span class="o">&lt;</span> <span class="n">alphas</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">C</span> <span class="o">&gt;</span> <span class="n">alphas</span><span class="p">[</span><span class="n">j</span><span class="p">]):</span>
                    <span class="n">b</span> <span class="o">=</span> <span class="n">b2</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="n">b1</span> <span class="o">+</span> <span class="n">b2</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0</span>
                <span class="n">alphaPairsChanged</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">print</span><span class="p">(</span><span class="s2">&quot;iter: </span><span class="si">%d</span><span class="s2"> i:</span><span class="si">%d</span><span class="s2">, pairs changed </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">iter</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">alphaPairsChanged</span><span class="p">))</span>
        <span class="c1"># 在for循环外，检查alpha值是否做了更新，如果在更新则将iter设为0后继续运行程序</span>
        <span class="c1"># 知道更新完毕后，iter次循环无变化，才推出循环。</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">alphaPairsChanged</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
            <span class="nb">iter</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">iter</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;iteration number: </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">iter</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">b</span><span class="p">,</span> <span class="n">alphas</span>
</pre></div>

<p><a href="https://github.com/apachecn/MachineLearning/blob/master/src/python/6.SVM/svm-simple.py">完整代码地址：SVM简化版，应用简化版SMO算法处理小规模数据集</a>: <a href="https://github.com/apachecn/MachineLearning/blob/master/src/python/6.SVM/svm-simple.py">https://github.com/apachecn/MachineLearning/blob/master/src/python/6.SVM/svm-simple.py</a></p>
<p><a href="https://github.com/apachecn/MachineLearning/blob/master/src/python/6.SVM/svm-complete_Non-Kernel.py">完整代码地址：SVM完整版，使用完整 Platt SMO算法加速优化，优化点：选择alpha的方式不同</a>: <a href="https://github.com/apachecn/MachineLearning/blob/master/src/python/6.SVM/svm-complete_Non-Kernel.py">https://github.com/apachecn/MachineLearning/blob/master/src/python/6.SVM/svm-complete_Non-Kernel.py</a></p>
<h2 id="kernel">核函数(kernel) 使用<a class="headerlink" href="#kernel" title="Permanent link">&para;</a></h2>
<ul>
<li>对于线性可分的情况，效果明显</li>
<li>对于非线性的情况也一样，此时需要用到一种叫<code>核函数(kernel)</code>的工具将数据转化为分类器易于理解的形式。</li>
</ul>
<blockquote>
<p>利用核函数将数据映射到高维空间</p>
</blockquote>
<ul>
<li>使用核函数：可以将数据从某个特征空间到另一个特征空间的映射。（通常情况下：这种映射会将低维特征空间映射到高维空间。）</li>
<li>如果觉得特征空间很装逼、很难理解。</li>
<li>可以把核函数想象成一个包装器(wrapper)或者是接口(interface)，它能将数据从某个很难处理的形式转换成为另一个较容易处理的形式。</li>
<li>经过空间转换后：低维需要解决的非线性问题，就变成了高维需要解决的线性问题。</li>
<li>SVM 优化特别好的地方，在于所有的运算都可以写成内积(inner product: 是指2个向量相乘，得到单个标量 或者 数值)；内积替换成核函数的方式被称为<code>核技巧(kernel trick)</code>或者<code>核&quot;变电&quot;(kernel substation)</code></li>
<li>核函数并不仅仅应用于支持向量机，很多其他的机器学习算法也都用到核函数。最流行的核函数：径向基函数(radial basis function)</li>
<li>径向基函数的高斯版本，其具体的公式为：</li>
</ul>
<p><img alt="径向基函数的高斯版本" src="../resources/6.SVM/SVM_6_radial-basis-function.jpg" /></p>
<h3 id="_10">项目案例: 手写数字识别的优化（有核函数）<a class="headerlink" href="#_10" title="Permanent link">&para;</a></h3>
<h4 id="_11">项目概述<a class="headerlink" href="#_11" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><span class="err">你的老板要求：你写的那个手写识别程序非常好，但是它占用内存太大。顾客无法通过无线的方式下载我们的应用。</span>
<span class="err">所以：我们可以考虑使用支持向量机，保留支持向量就行（</span><span class="n">knn</span><span class="err">需要保留所有的向量），就可以获得非常好的效果。</span>
</pre></div>

<h4 id="_12">开发流程<a class="headerlink" href="#_12" title="Permanent link">&para;</a></h4>
<blockquote>
<p>收集数据：提供的文本文件</p>
</blockquote>
<div class="codehilite"><pre><span></span><span class="mo">00000000000000001111000000000000</span>
<span class="mo">00000000000000011111111000000000</span>
<span class="mo">00000000000000011111111100000000</span>
<span class="mo">00000000000000011111111110000000</span>
<span class="mo">00000000000000011111111110000000</span>
<span class="mo">00000000000000111111111100000000</span>
<span class="mo">00000000000000111111111100000000</span>
<span class="mo">00000000000001111111111100000000</span>
<span class="mo">00000000000000111111111100000000</span>
<span class="mo">00000000000000111111111100000000</span>
<span class="mo">00000000000000111111111000000000</span>
<span class="mo">00000000000001111111111000000000</span>
<span class="mo">00000000000011111111111000000000</span>
<span class="mo">00000000000111111111110000000000</span>
<span class="mo">00000000001111111111111000000000</span>
<span class="mo">00000001111111111111111000000000</span>
<span class="mo">00000011111111111111110000000000</span>
<span class="mo">00000111111111111111110000000000</span>
<span class="mo">00000111111111111111110000000000</span>
<span class="mo">00000001111111111111110000000000</span>
<span class="mo">00000001111111011111110000000000</span>
<span class="mo">00000000111100011111110000000000</span>
<span class="mo">00000000000000011111110000000000</span>
<span class="mo">00000000000000011111100000000000</span>
<span class="mo">00000000000000111111110000000000</span>
<span class="mo">00000000000000011111110000000000</span>
<span class="mo">00000000000000011111110000000000</span>
<span class="mo">00000000000000011111111000000000</span>
<span class="mo">00000000000000011111111000000000</span>
<span class="mo">00000000000000011111111000000000</span>
<span class="mo">00000000000000000111111110000000</span>
<span class="mo">00000000000000000111111100000000</span>
</pre></div>

<blockquote>
<p>准备数据：基于二值图像构造向量</p>
</blockquote>
<p><code>将 32*32的文本转化为 1*1024的矩阵</code></p>
<div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">img2vector</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
    <span class="n">returnVect</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1024</span><span class="p">))</span>
    <span class="n">fr</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">32</span><span class="p">):</span>
        <span class="n">lineStr</span> <span class="o">=</span> <span class="n">fr</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">32</span><span class="p">):</span>
            <span class="n">returnVect</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">32</span> <span class="o">*</span> <span class="n">i</span> <span class="o">+</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">lineStr</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">returnVect</span>

<span class="k">def</span> <span class="nf">loadImages</span><span class="p">(</span><span class="n">dirName</span><span class="p">):</span>
    <span class="kn">from</span> <span class="nn">os</span> <span class="kn">import</span> <span class="n">listdir</span>
    <span class="n">hwLabels</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">print</span><span class="p">(</span><span class="n">dirName</span><span class="p">)</span>
    <span class="n">trainingFileList</span> <span class="o">=</span> <span class="n">listdir</span><span class="p">(</span><span class="n">dirName</span><span class="p">)</span>  <span class="c1"># load the training set</span>
    <span class="n">m</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">trainingFileList</span><span class="p">)</span>
    <span class="n">trainingMat</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">((</span><span class="n">m</span><span class="p">,</span> <span class="mi">1024</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
        <span class="n">fileNameStr</span> <span class="o">=</span> <span class="n">trainingFileList</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">fileStr</span> <span class="o">=</span> <span class="n">fileNameStr</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># take off .txt</span>
        <span class="n">classNumStr</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">fileStr</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">classNumStr</span> <span class="o">==</span> <span class="mi">9</span><span class="p">:</span>
            <span class="n">hwLabels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">hwLabels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">trainingMat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">img2vector</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">/</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">dirName</span><span class="p">,</span> <span class="n">fileNameStr</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">trainingMat</span><span class="p">,</span> <span class="n">hwLabels</span>
</pre></div>

<blockquote>
<p>分析数据：对图像向量进行目测</p>
<p>训练算法：采用两种不同的核函数，并对径向基核函数采用不同的设置来运行SMO算法</p>
</blockquote>
<div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">kernelTrans</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">kTup</span><span class="p">):</span>  <span class="c1"># calc the kernel or transform data to a higher dimensional space</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    核转换函数</span>
<span class="sd">    Args:</span>
<span class="sd">        X     dataMatIn数据集</span>
<span class="sd">        A     dataMatIn数据集的第i行的数据</span>
<span class="sd">        kTup  核函数的信息</span>

<span class="sd">    Returns:</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">m</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">shape</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="n">K</span> <span class="o">=</span> <span class="n">mat</span><span class="p">(</span><span class="n">zeros</span><span class="p">((</span><span class="n">m</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span>
    <span class="k">if</span> <span class="n">kTup</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;lin&#39;</span><span class="p">:</span>
        <span class="c1"># linear kernel:   m*n * n*1 = m*1</span>
        <span class="n">K</span> <span class="o">=</span> <span class="n">X</span> <span class="o">*</span> <span class="n">A</span><span class="o">.</span><span class="n">T</span>
    <span class="k">elif</span> <span class="n">kTup</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;rbf&#39;</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
            <span class="n">deltaRow</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="p">:]</span> <span class="o">-</span> <span class="n">A</span>
            <span class="n">K</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">deltaRow</span> <span class="o">*</span> <span class="n">deltaRow</span><span class="o">.</span><span class="n">T</span>
        <span class="c1"># 径向基函数的高斯版本</span>
        <span class="n">K</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="n">K</span> <span class="o">/</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">kTup</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>  <span class="c1"># divide in NumPy is element-wise not matrix like Matlab</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NameError</span><span class="p">(</span><span class="s1">&#39;Houston We Have a Problem -- That Kernel is not recognized&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">K</span>

<span class="k">def</span> <span class="nf">smoP</span><span class="p">(</span><span class="n">dataMatIn</span><span class="p">,</span> <span class="n">classLabels</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">toler</span><span class="p">,</span> <span class="n">maxIter</span><span class="p">,</span> <span class="n">kTup</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;lin&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    完整SMO算法外循环，与smoSimple有些类似，但这里的循环退出条件更多一些</span>
<span class="sd">    Args:</span>
<span class="sd">        dataMatIn    数据集</span>
<span class="sd">        classLabels  类别标签</span>
<span class="sd">        C   松弛变量(常量值)，允许有些数据点可以处于分隔面的错误一侧。</span>
<span class="sd">            控制最大化间隔和保证大部分的函数间隔小于1.0这两个目标的权重。</span>
<span class="sd">            可以通过调节该参数达到不同的结果。</span>
<span class="sd">        toler   容错率</span>
<span class="sd">        maxIter 退出前最大的循环次数</span>
<span class="sd">        kTup    包含核函数信息的元组</span>
<span class="sd">    Returns:</span>
<span class="sd">        b       模型的常量值</span>
<span class="sd">        alphas  拉格朗日乘子</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># 创建一个 optStruct 对象</span>
    <span class="n">oS</span> <span class="o">=</span> <span class="n">optStruct</span><span class="p">(</span><span class="n">mat</span><span class="p">(</span><span class="n">dataMatIn</span><span class="p">),</span> <span class="n">mat</span><span class="p">(</span><span class="n">classLabels</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">(),</span> <span class="n">C</span><span class="p">,</span> <span class="n">toler</span><span class="p">,</span> <span class="n">kTup</span><span class="p">)</span>
    <span class="nb">iter</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">entireSet</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="n">alphaPairsChanged</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># 循环遍历：循环maxIter次 并且 （alphaPairsChanged存在可以改变 or 所有行遍历一遍）</span>
    <span class="k">while</span> <span class="p">(</span><span class="nb">iter</span> <span class="o">&lt;</span> <span class="n">maxIter</span><span class="p">)</span> <span class="ow">and</span> <span class="p">((</span><span class="n">alphaPairsChanged</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">entireSet</span><span class="p">)):</span>
        <span class="n">alphaPairsChanged</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1">#  当entireSet=true or 非边界alpha对没有了；就开始寻找 alpha对，然后决定是否要进行else。</span>
        <span class="k">if</span> <span class="n">entireSet</span><span class="p">:</span>
            <span class="c1"># 在数据集上遍历所有可能的alpha</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">oS</span><span class="o">.</span><span class="n">m</span><span class="p">):</span>
                <span class="c1"># 是否存在alpha对，存在就+1</span>
                <span class="n">alphaPairsChanged</span> <span class="o">+=</span> <span class="n">innerL</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">oS</span><span class="p">)</span>
                <span class="c1"># print(&quot;fullSet, iter: %d i:%d, pairs changed %d&quot; % (iter, i, alphaPairsChanged))</span>
            <span class="nb">iter</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="c1"># 对已存在 alpha对，选出非边界的alpha值，进行优化。</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># 遍历所有的非边界alpha值，也就是不在边界0或C上的值。</span>
            <span class="n">nonBoundIs</span> <span class="o">=</span> <span class="n">nonzero</span><span class="p">((</span><span class="n">oS</span><span class="o">.</span><span class="n">alphas</span><span class="o">.</span><span class="n">A</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">oS</span><span class="o">.</span><span class="n">alphas</span><span class="o">.</span><span class="n">A</span> <span class="o">&lt;</span> <span class="n">C</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">nonBoundIs</span><span class="p">:</span>
                <span class="n">alphaPairsChanged</span> <span class="o">+=</span> <span class="n">innerL</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">oS</span><span class="p">)</span>
                <span class="c1"># print(&quot;non-bound, iter: %d i:%d, pairs changed %d&quot; % (iter, i, alphaPairsChanged))</span>
            <span class="nb">iter</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="c1"># 如果找到alpha对，就优化非边界alpha值，否则，就重新进行寻找，如果寻找一遍 遍历所有的行还是没找到，就退出循环。</span>
        <span class="k">if</span> <span class="n">entireSet</span><span class="p">:</span>
            <span class="n">entireSet</span> <span class="o">=</span> <span class="bp">False</span>  <span class="c1"># toggle entire set loop</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">alphaPairsChanged</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
            <span class="n">entireSet</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;iteration number: </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">iter</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">oS</span><span class="o">.</span><span class="n">b</span><span class="p">,</span> <span class="n">oS</span><span class="o">.</span><span class="n">alphas</span>
</pre></div>

<blockquote>
<p>测试算法：便携一个函数来测试不同的和函数并计算错误率</p>
</blockquote>
<div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">testDigits</span><span class="p">(</span><span class="n">kTup</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;rbf&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">)):</span>

    <span class="c1"># 1. 导入训练数据</span>
    <span class="n">dataArr</span><span class="p">,</span> <span class="n">labelArr</span> <span class="o">=</span> <span class="n">loadImages</span><span class="p">(</span><span class="s1">&#39;input/6.SVM/trainingDigits&#39;</span><span class="p">)</span>
    <span class="n">b</span><span class="p">,</span> <span class="n">alphas</span> <span class="o">=</span> <span class="n">smoP</span><span class="p">(</span><span class="n">dataArr</span><span class="p">,</span> <span class="n">labelArr</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mf">0.0001</span><span class="p">,</span> <span class="mi">10000</span><span class="p">,</span> <span class="n">kTup</span><span class="p">)</span>
    <span class="n">datMat</span> <span class="o">=</span> <span class="n">mat</span><span class="p">(</span><span class="n">dataArr</span><span class="p">)</span>
    <span class="n">labelMat</span> <span class="o">=</span> <span class="n">mat</span><span class="p">(</span><span class="n">labelArr</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
    <span class="n">svInd</span> <span class="o">=</span> <span class="n">nonzero</span><span class="p">(</span><span class="n">alphas</span><span class="o">.</span><span class="n">A</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">sVs</span> <span class="o">=</span> <span class="n">datMat</span><span class="p">[</span><span class="n">svInd</span><span class="p">]</span>
    <span class="n">labelSV</span> <span class="o">=</span> <span class="n">labelMat</span><span class="p">[</span><span class="n">svInd</span><span class="p">]</span>
    <span class="c1"># print(&quot;there are %d Support Vectors&quot; % shape(sVs)[0])</span>
    <span class="n">m</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">shape</span><span class="p">(</span><span class="n">datMat</span><span class="p">)</span>
    <span class="n">errorCount</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
        <span class="n">kernelEval</span> <span class="o">=</span> <span class="n">kernelTrans</span><span class="p">(</span><span class="n">sVs</span><span class="p">,</span> <span class="n">datMat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:],</span> <span class="n">kTup</span><span class="p">)</span>
        <span class="c1"># 1*m * m*1 = 1*1 单个预测结果</span>
        <span class="n">predict</span> <span class="o">=</span> <span class="n">kernelEval</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">multiply</span><span class="p">(</span><span class="n">labelSV</span><span class="p">,</span> <span class="n">alphas</span><span class="p">[</span><span class="n">svInd</span><span class="p">])</span> <span class="o">+</span> <span class="n">b</span>
        <span class="k">if</span> <span class="n">sign</span><span class="p">(</span><span class="n">predict</span><span class="p">)</span> <span class="o">!=</span> <span class="n">sign</span><span class="p">(</span><span class="n">labelArr</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span> <span class="n">errorCount</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;the training error rate is: </span><span class="si">%f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">errorCount</span><span class="p">)</span> <span class="o">/</span> <span class="n">m</span><span class="p">))</span>

    <span class="c1"># 2. 导入测试数据</span>
    <span class="n">dataArr</span><span class="p">,</span> <span class="n">labelArr</span> <span class="o">=</span> <span class="n">loadImages</span><span class="p">(</span><span class="s1">&#39;input/6.SVM/testDigits&#39;</span><span class="p">)</span>
    <span class="n">errorCount</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">datMat</span> <span class="o">=</span> <span class="n">mat</span><span class="p">(</span><span class="n">dataArr</span><span class="p">)</span>
    <span class="n">labelMat</span> <span class="o">=</span> <span class="n">mat</span><span class="p">(</span><span class="n">labelArr</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
    <span class="n">m</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">shape</span><span class="p">(</span><span class="n">datMat</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
        <span class="n">kernelEval</span> <span class="o">=</span> <span class="n">kernelTrans</span><span class="p">(</span><span class="n">sVs</span><span class="p">,</span> <span class="n">datMat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:],</span> <span class="n">kTup</span><span class="p">)</span>
        <span class="c1"># 1*m * m*1 = 1*1 单个预测结果</span>
        <span class="n">predict</span> <span class="o">=</span> <span class="n">kernelEval</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">multiply</span><span class="p">(</span><span class="n">labelSV</span><span class="p">,</span> <span class="n">alphas</span><span class="p">[</span><span class="n">svInd</span><span class="p">])</span> <span class="o">+</span> <span class="n">b</span>
        <span class="k">if</span> <span class="n">sign</span><span class="p">(</span><span class="n">predict</span><span class="p">)</span> <span class="o">!=</span> <span class="n">sign</span><span class="p">(</span><span class="n">labelArr</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span> <span class="n">errorCount</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;the test error rate is: </span><span class="si">%f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">errorCount</span><span class="p">)</span> <span class="o">/</span> <span class="n">m</span><span class="p">))</span>
</pre></div>

<blockquote>
<p>使用算法：一个图像识别的完整应用还需要一些图像处理的知识，这里并不打算深入介绍</p>
</blockquote>
<p><a href="https://github.com/apachecn/MachineLearning/blob/master/src/python/6.SVM/svm-complete.py">完整代码地址</a>: <a href="https://github.com/apachecn/MachineLearning/blob/master/src/python/6.SVM/svm-complete.py">https://github.com/apachecn/MachineLearning/blob/master/src/python/6.SVM/svm-complete.py</a></p>
<hr />
<ul>
<li><strong>作者：<a href="http://cwiki.apachecn.org/display/~jiangzhonglian">片刻</a> <a href="http://cwiki.apachecn.org/display/~houfachao">geekidentity</a></strong></li>
<li><a href="https://github.com/apachecn/MachineLearning">GitHub地址</a>: <a href="https://github.com/apachecn/MachineLearning">https://github.com/apachecn/MachineLearning</a></li>
<li><strong>版权声明：欢迎转载学习 =&gt; 请标注信息来源于 <a href="http://www.apachecn.org/">ApacheCN</a></strong></li>
</ul>
                
                  
                
              
              
                
              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../05.Logistic回归/" title="5.Logistic回归" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  后退
                </span>
                5.Logistic回归
              </span>
            </div>
          </a>
        
        
          <a href="../06.1.支持向量机的几个通俗理解/" title="06.1.支持向量机的几个通俗理解" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  前进
                </span>
                06.1.支持向量机的几个通俗理解
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2016 - 2018 Martin Donath
          </div>
        
        powered by
        <a href="http://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    
      <a href="http://struct.cc" class="md-footer-social__link fa fa-globe"></a>
    
      <a href="https://github.com/1007530194" class="md-footer-social__link fa fa-github-alt"></a>
    
      <a href="https://twitter.com/1007530194" class="md-footer-social__link fa fa-twitter"></a>
    
      <a href="https://linkedin.com/in/1007530194" class="md-footer-social__link fa fa-linkedin"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../../assets/javascripts/application.189d7058.js"></script>
      
        
        
          
          <script src="../../../assets/javascripts/lunr/lunr.stemmer.support.js"></script>
          
            
              
                <script src="../../../assets/javascripts/lunr/tinyseg.js"></script>
              
              
                <script src="../../../assets/javascripts/lunr/lunr.jp.js"></script>
              
            
          
          
        
      
      <script>app.initialize({version:"0.17.3",url:{base:"../../.."}})</script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
    
    
      
        <script>
    !function (e, a, t, n, o, c, i) {
        e.GoogleAnalyticsObject = o, e.ga = e.ga || function () {
            (e.ga.q = e.ga.q || []).push(arguments)
        }, e.ga.l = 1 * new Date, c = a.createElement(t),
            i = a.getElementsByTagName(t)[0],
            c.async = 1,
            c.src = "https://www.google-analytics.com/analytics.js",
            i.parentNode.insertBefore(c, i)
    }(window, document, "script", 0, "ga"),
        ga("create", "UA-115879584-1", "auto"),
        ga("set", "anonymizeIp", !0), ga("send", "pageview");
    var links = document.getElementsByTagName("a");

    if (Array.prototype.map.call(links, function (e) {
            e.host != document.location.host && e.addEventListener("click", function () {
                var a = e.getAttribute("data-md-action") || "follow";
                ga("send", "event", "outbound", a, e.href)
            })
        }), document.forms.search) {
        var query = document.forms.search.query;
        query.addEventListener("blur", function () {
            if (this.value) {
                var e = document.location.pathname;
                ga("send", "pageview", e + "?q=" + this.value)
            }
        })
    }</script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-115879584-1"></script>
<script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
        dataLayer.push(arguments);
    }

    gtag('js', new Date());

    gtag('config', 'UA-115879584-1');
</script>
      
    
  </body>
</html>